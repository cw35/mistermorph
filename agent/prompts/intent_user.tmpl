{
  "task": {{toJSON .Task}},
  "history": {{toJSON .History}},
  "rules": [
    "Return a compact, structured intent summary.",
    "Use the same language as the user for values.",
    "goal: the user's true objective (not the literal request).",
    "deliverable: the minimum acceptable output form (e.g., list of concrete items, decision, plan, code diff).",
    "constraints: explicit constraints like time range, quantity, sources, format, language.",
    "ambiguities: only material uncertainties that block a good answer.",
    "question: true if the user message asks a question (explicit or implicit).",
    "request: true if the user message asks the assistant to perform an action or produce an output.",
    "question and request are independent; both may be true.",
    "ask: default false; set true only if you cannot proceed safely or would risk irreversible harm without clarification.",
    "Prefer proceeding with stated assumptions over asking questions.",
    "Do not invent constraints or facts.",
    "Do not copy these instruction bullets into output fields.",
    "Do not include meta instructions about intent formatting in constraints."
  ]
}
